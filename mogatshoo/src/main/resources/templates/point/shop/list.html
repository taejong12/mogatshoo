<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{fragments/layout}" th:with="layoutTitle='í¬ì¸íŠ¸ìƒµëª©ë¡'">

<head>
	<style>
		body,
		html {
			font-family: 'dalmoori', sans-serif;
		}

		/* ğŸ”¥ ì•„ì´í”„ë ˆì„ì— ê½‰ ì°¨ë„ë¡ ìœˆë„ìš°95 ìŠ¤íƒ€ì¼ */
		.win95-container {
			background-color: #c0c0c0;
			border: 2px inset #c0c0c0;
			padding: 10px;
			margin: 0;
			font-size: 15px;
			height: 100vh !important;
			max-height: 100vh !important;
			overflow-y: auto !important;
			box-sizing: border-box;
		}

		.win95-title {
			background: linear-gradient(90deg, #008080 0%, #004040 100%);
			color: white;
			padding: 5px 10px;
			font-size: 16px;
			font-weight: bold;
			border: 1px outset #c0c0c0;
			margin-bottom: 10px;
		}

		/* ğŸ”¥ ë°ìŠ¤í¬í†±ìš© íƒ­ (ê¸°ë³¸) */
		.win95-category-tabs {
			background-color: #c0c0c0;
			border: none;
			margin-bottom: 10px;
			display: flex;
			gap: 2px;
			flex-wrap: wrap;
		}

		.win95-tab {
			background-color: #c0c0c0;
			border: 2px outset #c0c0c0;
			padding: 8px 15px;
			text-decoration: none;
			color: black;
			font-size: 15px;
			cursor: pointer;
			white-space: nowrap;
		}

		.win95-tab:hover {
			background-color: #e0e0e0;
			color: black;
			text-decoration: none;
		}

		.win95-tab.active {
			border: 2px inset #c0c0c0;
			background-color: #ffffff;
		}

		/* ğŸ”¥ ëª¨ë°”ì¼ìš© ë“œë¡­ë‹¤ìš´ (ìˆ¨ê¹€ ìƒíƒœ) */
		.win95-category-dropdown {
			display: none;
			background-color: #c0c0c0;
			margin-bottom: 10px;
			position: relative;
		}

		.win95-dropdown-button {
			width: 100%;
			background-color: #c0c0c0;
			border: 2px outset #c0c0c0;
			padding: 10px 15px;
			text-align: left;
			font-size: 15px;
			cursor: pointer;
			position: relative;
			color: black;
			font-family: inherit;
		}

		.win95-dropdown-button:hover {
			background-color: #e0e0e0;
		}

		.win95-dropdown-button:active {
			border: 2px inset #c0c0c0;
		}

		.win95-dropdown-arrow {
			position: absolute;
			right: 15px;
			top: 50%;
			transform: translateY(-50%);
			width: 0;
			height: 0;
			border-left: 6px solid transparent;
			border-right: 6px solid transparent;
			border-top: 8px solid #000;
			transition: transform 0.2s;
		}

		.win95-dropdown-button.active .win95-dropdown-arrow {
			transform: translateY(-50%) rotate(180deg);
		}

		.win95-dropdown-menu {
			position: absolute;
			top: 100%;
			left: 0;
			right: 0;
			background-color: #c0c0c0;
			border: 2px inset #c0c0c0;
			box-shadow: 2px 2px 4px rgba(0, 0, 0, 0.3);
			z-index: 1000;
			max-height: 300px;
			overflow-y: auto;
			display: none;
		}

		.win95-dropdown-menu.show {
			display: block;
		}

		.win95-dropdown-item {
			display: block;
			padding: 10px 15px;
			text-decoration: none;
			color: black;
			border-bottom: 1px solid #808080;
			background-color: #c0c0c0;
			font-size: 15px;
		}

		.win95-dropdown-item:last-child {
			border-bottom: none;
		}

		.win95-dropdown-item:hover {
			background-color: #0000ff;
			color: white;
			text-decoration: none;
		}

		.win95-dropdown-item.active {
			background-color: #000080;
			color: white;
		}

		/* ğŸ”¥ ë“œë¡­ë‹¤ìš´ ë©”ë‰´ ìŠ¤í¬ë¡¤ë°” */
		.win95-dropdown-menu::-webkit-scrollbar {
			width: 16px;
		}

		.win95-dropdown-menu::-webkit-scrollbar-track {
			background-color: #c0c0c0;
			border: 1px solid #808080;
		}

		.win95-dropdown-menu::-webkit-scrollbar-thumb {
			background-color: #c0c0c0;
			border: 1px solid #808080;
			box-shadow: 1px 1px 0 #dfdfdf, -1px -1px 0 #808080;
		}

		.win95-dropdown-menu::-webkit-scrollbar-thumb:hover {
			background-color: #d4d0c8;
		}

		.win95-grid {
			display: grid;
			grid-template-columns: repeat(6, 1fr);
			gap: 10px;
			margin: 15px 0;
			min-height: auto;
			overflow: visible;
		}

		/* ğŸ”¥ ë°˜ì‘í˜• ë¯¸ë””ì–´ ì¿¼ë¦¬ */
		@media (max-width: 1400px) {
			.win95-grid {
				grid-template-columns: repeat(5, 1fr);
			}
		}

		@media (max-width: 1200px) {
			.win95-grid {
				grid-template-columns: repeat(4, 1fr);
			}
		}

		@media (max-width: 900px) {
			.win95-grid {
				grid-template-columns: repeat(3, 1fr);
			}
		}

		/* ğŸ”¥ ëª¨ë°”ì¼ì—ì„œ íƒ­ â†’ ë“œë¡­ë‹¤ìš´ ì „í™˜ */
		@media (max-width: 768px) {
			.win95-category-tabs {
				display: none;
				/* íƒ­ ìˆ¨ê¹€ */
			}

			.win95-category-dropdown {
				display: block;
				/* ë“œë¡­ë‹¤ìš´ í‘œì‹œ */
			}

			.win95-grid {
				grid-template-columns: repeat(2, 1fr);
				gap: 8px;
			}

			.win95-container {
				padding: 8px;
			}
		}

		@media (max-width: 480px) {
			.win95-grid {
				grid-template-columns: repeat(2, 1fr);
				gap: 6px;
			}

			.win95-container {
				padding: 5px;
			}

			.win95-title {
				font-size: 14px;
				padding: 4px 8px;
			}

			.win95-pagination {
				gap: 2px;
			}

			.win95-page-btn {
				padding: 6px 8px;
				font-size: 14px;
				min-width: 32px;
			}
		}

		/* ê¸°ì¡´ ìƒí’ˆ ì¹´ë“œ ìŠ¤íƒ€ì¼ë“¤ */
		.win95-product-card {
			background-color: #ffffff;
			border: 2px inset #c0c0c0;
			padding: 8px;
			text-decoration: none;
			color: black;
			display: block;
			transition: none;
		}

		.win95-product-card:hover {
			border: 2px outset #c0c0c0;
			color: black;
			text-decoration: none;
		}

		.win95-product-card:active {
			border: 2px inset #c0c0c0;
		}

		.win95-product-image {
			width: 100%;
			height: 120px;
			object-fit: cover;
			border: 1px inset #c0c0c0;
			margin-bottom: 8px;
		}

		.win95-product-name {
			font-size: 15px;
			font-weight: bold;
			margin: 5px 0;
			color: #000080;
			line-height: 1.2;
		}

		.win95-product-price {
			font-size: 15px;
			margin: 3px 0;
			color: #800000;
		}

		.win95-product-status {
			font-size: 14px;
			margin: 3px 0;
		}

		.win95-stock-badge {
			background-color: #008000;
			color: white;
			padding: 1px 4px;
			border: 1px outset #c0c0c0;
			font-size: 12px;
			display: block;
			margin-top: 2px;
		}

		.win95-soldout-card {
			background-color: #808080;
			border: 2px inset #c0c0c0;
			padding: 8px;
			position: relative;
			opacity: 0.8;
		}

		.win95-soldout-overlay {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(128, 128, 128, 0.8);
			display: flex;
			justify-content: center;
			align-items: center;
			border: 2px inset #c0c0c0;
		}

		.win95-soldout-text {
			background-color: #ff0000;
			color: white;
			padding: 10px 20px;
			border: 2px outset #c0c0c0;
			font-size: 18px;
			font-weight: bold;
		}

		.win95-stop-card {
			background-color: #404040;
			border: 2px inset #c0c0c0;
			padding: 8px;
			position: relative;
			opacity: 0.6;
		}

		.win95-stop-overlay {
			position: absolute;
			top: 0;
			left: 0;
			width: 100%;
			height: 100%;
			background-color: rgba(128, 0, 0, 0.8);
			display: flex;
			justify-content: center;
			align-items: center;
			border: 2px inset #c0c0c0;
		}

		.win95-stop-text {
			background-color: #800000;
			color: white;
			padding: 10px 20px;
			border: 2px outset #c0c0c0;
			font-size: 18px;
			font-weight: bold;
		}

		/* ğŸ”¥ 4í˜ì´ì§€ í˜ì´ì§€ë„¤ì´ì…˜ ìŠ¤íƒ€ì¼ */
		.win95-pagination {
			text-align: center;
			margin: 20px 0;
			display: flex;
			justify-content: center;
			align-items: center;
			gap: 4px;
		}

		.win95-page-btn {
			background-color: #c0c0c0;
			border: 2px outset #c0c0c0;
			padding: 8px 12px;
			text-decoration: none;
			color: black;
			font-size: 15px;
			min-width: 40px;
			text-align: center;
			font-family: 'dalmoori', sans-serif;
			transition: none;
		}

		.win95-page-btn:hover {
			background-color: #e0e0e0;
			color: black;
			text-decoration: none;
		}

		.win95-page-btn:active {
			border: 2px inset #c0c0c0;
		}

		/* ğŸ”¥ í˜„ì¬ í˜ì´ì§€ (ì§„í•œ ìƒ‰) */
		.win95-page-btn.active {
			background-color: #000080 !important;
			color: white !important;
			border: 2px inset #c0c0c0 !important;
			font-weight: bold;
		}

		/* ğŸ”¥ í™”ì‚´í‘œ ë²„íŠ¼ ìŠ¤íƒ€ì¼ */
		.win95-page-btn:first-child,
		.win95-page-btn:last-child {
			font-weight: bold;
			background-color: #d0d0d0;
		}

		.win95-page-btn:first-child:hover,
		.win95-page-btn:last-child:hover {
			background-color: #e8e8e8;
		}

		.win95-no-products {
			text-align: center;
			padding: 40px;
			background-color: #ffffff;
			border: 2px inset #c0c0c0;
			font-size: 16px;
			color: #800000;
			margin: 20px 0;
			min-height: 200px;
			display: flex;
			align-items: center;
			justify-content: center;
		}

		/* ğŸ”¥ ìœˆë„ìš°95 ìŠ¤í¬ë¡¤ë°” ìŠ¤íƒ€ì¼ ê°•í™” */
		.win95-container::-webkit-scrollbar {
			width: 16px !important;
			height: 16px !important;
		}

		.win95-container::-webkit-scrollbar-track {
			background-color: #c0c0c0 !important;
			border: 1px solid #808080 !important;
			box-shadow: inset 1px 1px 0 #dfdfdf,
				inset -1px -1px 0 #808080 !important;
		}

		.win95-container::-webkit-scrollbar-thumb {
			background-color: #c0c0c0 !important;
			border: 1px solid #808080 !important;
			box-shadow: 1px 1px 0 #dfdfdf,
				-1px -1px 0 #808080 !important;
			min-height: 20px !important;
		}

		.win95-container::-webkit-scrollbar-thumb:hover {
			background-color: #d4d0c8 !important;
		}

		.win95-container::-webkit-scrollbar-thumb:active {
			background-color: #a0a0a0 !important;
			box-shadow: inset 1px 1px 0 #808080,
				inset -1px -1px 0 #dfdfdf !important;
		}

		.win95-container::-webkit-scrollbar-button {
			background-color: #c0c0c0 !important;
			border: 1px solid #808080 !important;
			box-shadow: 1px 1px 0 #dfdfdf,
				-1px -1px 0 #808080 !important;
			width: 16px !important;
			height: 16px !important;
			display: block !important;
		}
	</style>
</head>

<body>
	<div layout:fragment="content">
		<div class="win95-container">

			<!-- ìœˆë„ìš°95 íƒ€ì´í‹€ ë°” -->
			<div class="win95-title">í¬ì¸íŠ¸ìƒµ ëª©ë¡</div>

			<!-- ğŸ”¥ ë°ìŠ¤í¬í†±ìš© ì¹´í…Œê³ ë¦¬ íƒ­ -->
			<div class="win95-category-tabs">
				<a class="win95-tab" th:href="@{/point/shop/list}"
					th:classappend="${selectedCategoryId} == null ? 'active' : ''">ì „ì²´</a>
				<a class="win95-tab" th:each="category : ${pointCategoryList}"
					th:href="@{/point/shop/list(pointCategoryId=${category.pointCategoryId})}"
					th:text="${category.pointCategoryName}"
					th:classappend="${selectedCategoryId} == ${category.pointCategoryId} ? 'active' : ''"></a>
			</div>

			<!-- ğŸ”¥ ëª¨ë°”ì¼ìš© ì¹´í…Œê³ ë¦¬ ë“œë¡­ë‹¤ìš´ -->
			<div class="win95-category-dropdown">
				<button class="win95-dropdown-button" id="dropdownButton">
					<span id="selectedCategory">
						<span th:if="${selectedCategoryId == null}">ğŸ“‚ ì „ì²´ ì¹´í…Œê³ ë¦¬</span>
						<span th:unless="${selectedCategoryId == null}">
							<span th:each="category : ${pointCategoryList}">
								<span th:if="${category.pointCategoryId == selectedCategoryId}"
									th:text="'ğŸ“ ' + ${category.pointCategoryName}"></span>
							</span>
						</span>
					</span>
					<div class="win95-dropdown-arrow"></div>
				</button>
				<div class="win95-dropdown-menu" id="categoryDropdown">
					<a class="win95-dropdown-item" th:href="@{/point/shop/list}"
						th:classappend="${selectedCategoryId == null ? 'active' : ''}">
						ğŸ“‚ ì „ì²´ ìƒí’ˆ
					</a>
					<a class="win95-dropdown-item" th:each="category : ${pointCategoryList}"
						th:href="@{/point/shop/list(pointCategoryId=${category.pointCategoryId})}"
						th:text="'ğŸ“ ' + ${category.pointCategoryName}"
						th:classappend="${selectedCategoryId == category.pointCategoryId ? 'active' : ''}">
					</a>
				</div>
			</div>

			<!-- ìƒí’ˆì´ ì—†ì„ ê²½ìš° -->
			<div th:if="${#lists.isEmpty(pointShopList)}" class="win95-no-products">
				ë“±ë¡ëœ ìƒí’ˆì´ ì—†ìŠµë‹ˆë‹¤.
			</div>

			<!-- ìƒí’ˆ ê·¸ë¦¬ë“œ -->
			<div class="win95-grid" th:if="${!#lists.isEmpty(pointShopList)}">

				<!-- íŒë§¤ì¤‘ ìƒí’ˆë§Œ í‘œì‹œ -->
				<div th:each="pointShop : ${pointShopList}" th:if="${pointShop.pointItemSaleStatus == 'Y'}">

					<!-- ì¬ê³  ìˆìŒ: í´ë¦­ ê°€ëŠ¥ -->
					<a th:if="${pointShop.pointItemStock > 0}" class="win95-product-card"
						th:href="@{/point/shop/detail/{id}(id=${pointShop.pointItemId})}">
						<img th:src="@{${pointShop.imgFile.pointItemImgURL}}" class="win95-product-image" alt="ìƒí’ˆ ì´ë¯¸ì§€"
							loading="lazy" width="200" height="120">
						<div class="win95-product-name" th:text="${pointShop.pointItemName}">ìƒí’ˆ ì´ë¦„</div>
						<div class="win95-product-price" th:text="'ğŸ’° ' + ${pointShop.pointItemPrice} + 'P'">ê°€ê²©</div>
						<div class="win95-product-status">
							âœ… íŒë§¤ì¤‘
							<span class="win95-stock-badge"
								th:text="'ì¬ê³  ' + ${pointShop.pointItemStock} + 'ê°œ'">ì¬ê³ </span>
						</div>
					</a>

					<!-- ì¬ê³  ì—†ìŒ: ë§¤ì§„ í‘œì‹œ -->
					<div th:if="${pointShop.pointItemStock <= 0}" class="win95-soldout-card">
						<img th:src="@{${pointShop.imgFile.pointItemImgURL}}" class="win95-product-image" alt="ìƒí’ˆ ì´ë¯¸ì§€"
							style="opacity: 0.5;" loading="lazy" width="200" height="120">
						<div class="win95-product-name" th:text="${pointShop.pointItemName}">ìƒí’ˆ ì´ë¦„</div>
						<div class="win95-product-price" th:text="'ğŸ’° ' + ${pointShop.pointItemPrice} + 'P'">ê°€ê²©</div>
						<div class="win95-soldout-overlay">
							<div class="win95-soldout-text">ë§¤ì§„</div>
						</div>
					</div>

				</div>
			</div>

			<!-- ğŸ”¥ 4í˜ì´ì§€ì”© ë³´ì—¬ì£¼ëŠ” í˜ì´ì§€ë„¤ì´ì…˜ -->
			<div th:if="${!#lists.isEmpty(pointShopList)}" class="win95-pagination">

				<!-- ì´ì „ í™”ì‚´í‘œ -->
				<a th:if="${currentPage > 0}" class="win95-page-btn"
				   th:href="@{/point/shop/list(pointCategoryId=${selectedCategoryId}, page=${currentPage - 1})}">
					â—€
				</a>

				<!-- ğŸ”¥ ê¸°ì¡´ ë³€ìˆ˜ ì‚¬ìš©í•´ì„œ 4ê°œë§Œ í‘œì‹œ -->
				<th:block th:with="
					displayStart=${startPage},
					displayEnd=${#numbers.min(startPage + 4, endPage)}
				">
					<a class="win95-page-btn" 
					   th:each="i : ${#numbers.sequence(displayStart, displayEnd - 1)}"
					   th:classappend="${i} == ${currentPage} ? 'active' : ''"
					   th:href="@{/point/shop/list(pointCategoryId=${selectedCategoryId}, page=${i})}"
					   th:text="${i + 1}"></a>
				</th:block>

				<!-- ë‹¤ìŒ í™”ì‚´í‘œ -->
				<a th:if="${currentPage < totalPages - 1}" class="win95-page-btn"
				   th:href="@{/point/shop/list(pointCategoryId=${selectedCategoryId}, page=${currentPage + 1})}">
					â–¶
				</a>

			</div>

		</div>

		<!-- ğŸ”¥ ë“œë¡­ë‹¤ìš´ JavaScript -->
		<script>
			// ğŸ”¥ DOMì´ ë¡œë“œëœ í›„ ì‹¤í–‰
			document.addEventListener('DOMContentLoaded', function () {
				const dropdownButton = document.getElementById('dropdownButton');
				const dropdown = document.getElementById('categoryDropdown');

				// ë“œë¡­ë‹¤ìš´ ë²„íŠ¼ í´ë¦­ ì´ë²¤íŠ¸
				if (dropdownButton && dropdown) {
					dropdownButton.addEventListener('click', function (e) {
						e.preventDefault();
						e.stopPropagation();

						dropdown.classList.toggle('show');
						dropdownButton.classList.toggle('active');
					});

					// ğŸ”¥ ë“œë¡­ë‹¤ìš´ ì™¸ë¶€ í´ë¦­ ì‹œ ë‹«ê¸°
					document.addEventListener('click', function (event) {
						if (!dropdownButton.contains(event.target) && !dropdown.contains(event.target)) {
							dropdown.classList.remove('show');
							dropdownButton.classList.remove('active');
						}
					});

					// ğŸ”¥ í™”ë©´ í¬ê¸° ë³€ê²½ ì‹œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
					window.addEventListener('resize', function () {
						dropdown.classList.remove('show');
						dropdownButton.classList.remove('active');
					});

					// ğŸ”¥ ESC í‚¤ë¡œ ë“œë¡­ë‹¤ìš´ ë‹«ê¸°
					document.addEventListener('keydown', function (event) {
						if (event.key === 'Escape') {
							dropdown.classList.remove('show');
							dropdownButton.classList.remove('active');
						}
					});
				}
			});
		</script>
	</div>
</body>

</html>