<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.thymeleaf.org/extras/spring-security">

<head>
   <meta charset="UTF-8">
   <link rel="stylesheet" th:href="@{/css/footer.css}">
</head>

<body>
   <div th:fragment="footer" class="footer">
      <div class="footer-left">
         <!-- Windows ì‹œì‘ ë²„íŠ¼ -->
         <div class="win-button" id="win-button">
            <img th:src="@{/img/footer/startBtn.JPG}" alt="Windows" />
            <span>ì‹œì‘</span>
         </div>

         <!-- í´ë” ì˜ì—­ -->
         <div class="footer-folders">
            <div class="footer-folder" onclick="openModal('terms')">
               <img th:src="@{/img/footer/mogetshooLogo.PNG}" alt="Terms" />
               <span>ë¬¸ì˜ ì‚¬í•­</span>
            </div>
            <div class="footer-folder" onclick="openModal2('company')">
               <img th:src="@{/img/footer/mogetshooLogo.PNG}" alt="Company" />
               <span>ì´ìš© ì•½ê´€</span>
            </div>
         </div>

         <!-- ë¡œê·¸ì¸ ì˜ì—­ (ìŠ¤í˜ì´ì„œ) -->
         <div class="footer-spacer"></div>

         <!-- ë¹„ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ í‘œì‹œë˜ëŠ” ë§í¬ -->
         <div sec:authorize="isAnonymous()" class="footer-auth">
            <div class="footer-folder">
               <a th:href="@{/member/login}" class="footer-link">
                  <img th:src="@{/img/footer/mogetshooLogo.PNG}" alt="ë¡œê·¸ì¸" />
                  <span>ë¡œê·¸ì¸</span>
               </a>
            </div>
            <div class="footer-folder">
               <a th:href="@{/member/join}" class="footer-link">
                  <img th:src="@{/img/footer/mogetshooLogo.PNG}" alt="íšŒì›ê°€ì…" />
                  <span>íšŒì›ê°€ì…</span>
               </a>
            </div>
         </div>

         <!-- ë¡œê·¸ì¸ ìƒíƒœì¼ ë•Œ í‘œì‹œë˜ëŠ” ë‚´ìš© -->
         <div sec:authorize="isAuthenticated()" class="footer-auth">
            <div class="footer-folder" id="auth-data" th:data-member-id="${#authentication.name}">
               <a th:href="@{/point/detail/list(memberId=${#authentication.name})}" class="footer-link">
                  <img th:src="@{/img/footer/point.png}" alt="í¬ì¸íŠ¸" />
                  <span>í¬ì¸íŠ¸</span>
               </a>
            </div>
            <div class="footer-folder">
               <a th:href="@{#}" class="footer-link">
                  <img th:src="@{/img/footer/point.png}" alt="ê²°ì œ ë‚´ì—­" />
                  <span>ê²°ì œ ë‚´ì—­</span>
               </a>
            </div>
            <div class="footer-folder">
               <a th:href="@{/member/mypage(memberId=${#authentication.name})}" class="footer-link">
                  <img th:src="@{/img/footer/myInfo.png}" alt="ë§ˆì´í˜ì´ì§€" />
                  <span th:text="${#authentication.principal.nickName}">ë‹˜</span>
               </a>
            </div>
            <div class="footer-folder">
               <button type="button" class="logout-btn" onclick="showFooterLogoutModal()">
                  <img th:src="@{/img/footer/logout.jpg}" alt="ë¡œê·¸ì•„ì›ƒ" />
               <span>ë¡œê·¸ì•„ì›ƒ</span></button>
                  
            </div>
         </div>
      </div>

      <!-- ì‹œê³„ ì˜ì—­ -->
      <div class="clock" id="clock">--:--</div>

      <!-- ëª¨ë‹¬ ì°½ -->
      <div id="modal" class="modal-window" style="display:none;">
         <div class="modal-header">
            <span id="modal-title">ì œëª©</span>
            <button onclick="closeModal()">X</button>
         </div>
         <div class="modal-content" id="modal-content">ë‚´ìš©</div>
      </div>

      <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
      <script defer th:src="@{/js/main/footer.js}"></script>

      <script>
         $(document).ready(function () {
            // ğŸš¨ í‘¸í„° ë§í¬ ì „ìš© ì´ë²¤íŠ¸ í•¸ë“¤ëŸ¬
            $('.footer-link').click(function (e) {
               e.preventDefault(); // ê¸°ë³¸ ë§í¬ ë™ì‘ ë°©ì§€
               e.stopPropagation(); // ì´ë²¤íŠ¸ ë²„ë¸”ë§ ì¤‘ì§€

               const file = $(this).attr('href');
               const title = $(this).find('span').text() || 'ë¬¸ì„œ';

               console.log('ğŸŸ¡ í‘¸í„° ë§í¬ í´ë¦­:', file, title);

               // '/' ë§í¬ëŠ” ì¼ë°˜ì ì¸ í˜ì´ì§€ ì´ë™ì„ ìˆ˜í–‰í•©ë‹ˆë‹¤.
               if (file === '/') {
                  window.location.href = file;
                  return;
               }

               // ë¡œê·¸ì¸/íšŒì›ê°€ì…ì€ ë©”ì¸ ìœˆë„ìš°ì—ì„œ ì²˜ë¦¬
               if (file.includes('/member/join') ||
                  file.includes('/member/login') ||
                  file.includes('/login') ||
                  file.includes('/oauth2/') ||
                  file.includes('/logout')) {

                  console.log('ğŸ”´ í‘¸í„°ì—ì„œ ë©”ì¸ ìœˆë„ìš° ì²˜ë¦¬:', file);
                  window.location.href = file;
               } else {
                  // í¬ì¸íŠ¸, ë§ˆì´í˜ì´ì§€ëŠ” iframeì—ì„œ ì²˜ë¦¬
                  console.log('ğŸ”µ í‘¸í„°ì—ì„œ iframe ì²˜ë¦¬:', file);
                  openFooterInIframe(file, title);
               }
            });
         });

         // í‘¸í„°ì—ì„œ iframe ì—´ê¸° (ì‚¬ì´ë“œë°”ì™€ ë™ì¼í•œ ë°©ì‹)
         function openFooterInIframe(file, title) {
            // ìœˆë„ìš° ì œëª© ì„¤ì •
            $('.win95-title-text').text(title);

            // ìœˆë„ìš° í‘œì‹œ ë° ìœ„ì¹˜ ì„¤ì •
            $('#win95Window').css({
               'display': 'block',
               'position': 'fixed',
               'left': '150px',
               'top': '50px',
               'transform': 'none'
            });

            // iframe ì†ŒìŠ¤ ì„¤ì •
            $('#windowContentFrame').attr('src', file);
         }

         // í‘¸í„° ë¡œê·¸ì•„ì›ƒ ëª¨ë‹¬ í•¨ìˆ˜
         function showFooterLogoutModal() {
            showConfirmModal();
         }
      </script>

   </div>
</body>

</html>