<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{fragments/layout}">
<head th:with="layoutTitle='Ìè¨Ïù∏Ìä∏ ÏÇ¨Ïö©ÎÇ¥Ïó≠'">
<style>
.p-win95-window {
    background: #c0c0c0;
    border: 2px outset #c0c0c0;
    box-shadow: 2px 2px 4px rgba(0,0,0,0.3);
    margin: 0 auto;
    max-width: 800px;
}

.p-title-bar {
    background: linear-gradient(90deg, #000080 0%, #1084d0 100%);
    color: white;
    padding: 2px;
    font-weight: bold;
    font-size: 11px;
    display: flex;
    justify-content: space-between;
    align-items: center;
}

.p-title-text {
    padding-left: 4px;
    display: flex;
    align-items: center;
    gap: 4px;
}

.p-title-icon {
    width: 16px;
    height: 16px;
    background: url('data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABAAAAAQCAYAAAAf8/9hAAAABHNCSVQICAgIfAhkiAAAAAlwSFlzAAAAdgAAAHYBTnsmCAAAABl0RVh0U29mdHdhcmUAd3d3Lmlua3NjYXBlLm9yZ5vuPBoAAAFYSURBVDiNpZM9SwNBEIafgJ2FhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhYWFhY=') center/contain no-repeat;
}

.p-window-controls {
    display: flex;
    gap: 2px;
}

.p-control-btn {
    width: 16px;
    height: 14px;
    background: #c0c0c0;
    border: 1px outset #c0c0c0;
    font-size: 9px;
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
}

.p-control-btn:active {
    border: 1px inset #c0c0c0;
}

.p-window-content {
    padding: 8px;
    background: #c0c0c0;
}

.p-main-title {
    font-size: 12px;
    font-weight: bold;
    margin: 0 0 8px 0;
    color: #000080;
    text-align: center;
}

.p-table-container {
    border: 2px inset #c0c0c0;
    background: white;
    margin-bottom: 8px;
    max-height: 400px;
    overflow-y: auto;
}

.p-main-table {
    width: 100%;
    border-collapse: collapse;
    background: white;
    font-size: 11px;
}

.p-table-head {
    background: #c0c0c0;
    position: sticky;
    top: 0;
}

.p-table-header {
    background: #c0c0c0;
    border: 1px outset #c0c0c0;
    padding: 4px 8px;
    font-weight: bold;
    text-align: left;
    font-size: 11px;
    white-space: nowrap;
}

.p-table-cell {
    border: 1px solid #e0e0e0;
    padding: 4px 8px;
    font-size: 11px;
    white-space: nowrap;
}

.p-table-row:nth-child(even) {
    background: #f0f0f0;
}

.p-table-row:hover {
    background: #0078d4;
    color: white;
}

.p-empty-message {
    text-align: center;
    padding: 20px;
    color: #666;
    font-style: italic;
}

.p-status-bar {
    background: #c0c0c0;
    border: 1px inset #c0c0c0;
    padding: 2px 8px;
    font-size: 11px;
    display: flex;
    justify-content: space-between;
    align-items: center;
    margin-top: 8px;
}

.p-pagination {
    display: flex;
    justify-content: center;
    gap: 2px;
    margin: 8px 0;
}

.p-pagination a, .p-pagination span {
    padding: 2px 8px;
    background: #c0c0c0;
    border: 1px outset #c0c0c0;
    text-decoration: none;
    color: black;
    font-size: 11px;
    min-width: 20px;
    text-align: center;
    display: inline-block;
}

.p-pagination a:hover {
    background: #e0e0e0;
}

.p-pagination a:active {
    border: 1px inset #c0c0c0;
}

.p-pagination a.p-active {
    background: #000080;
    color: white;
    border: 1px inset #c0c0c0;
}

.p-point-positive {
    color: #008000;
    font-weight: bold;
}

.p-point-negative {
    color: #800000;
    font-weight: bold;
}

.p-point-type-earn {
    color: #000080;
    font-weight: bold;
}

.p-point-type-use {
    color: #800080;
    font-weight: bold;
}

/* Ïä§ÌÅ¨Î°§Î∞î Ïä§ÌÉÄÏùºÎßÅ */
.p-table-container::-webkit-scrollbar {
    width: 16px;
}

.p-table-container::-webkit-scrollbar-track {
    background: #c0c0c0;
    border: 1px inset #c0c0c0;
}

.p-table-container::-webkit-scrollbar-thumb {
    background: #c0c0c0;
    border: 1px outset #c0c0c0;
}

.p-table-container::-webkit-scrollbar-button {
    background: #c0c0c0;
    border: 1px outset #c0c0c0;
    height: 16px;
}

.p-table-container::-webkit-scrollbar-button:vertical:start:decrement {
    background: #c0c0c0 url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M8 4l4 6H4z"/></svg>') center no-repeat;
}

.p-table-container::-webkit-scrollbar-button:vertical:end:increment {
    background: #c0c0c0 url('data:image/svg+xml,<svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16"><path d="M4 6l4 6 4-6z"/></svg>') center no-repeat;
}
</style>
</head>
<body>
<div layout:fragment="content">
    <div class="p-win95-window">
        <div class="p-window-content">
            <h1 class="p-main-title">Ìè¨Ïù∏Ìä∏ ÏÇ¨Ïö©ÎÇ¥Ïó≠</h1>
            
            <div class="p-table-container">
                <table class="p-main-table">
                    <thead class="p-table-head">
                        <tr>
                            <th class="p-table-header">ÎÇ¥Ïó≠</th>
                            <th class="p-table-header">Ìè¨Ïù∏Ìä∏Î≥ÄÎèô</th>
                            <th class="p-table-header">ÌÉÄÏûÖ</th>
                            <th class="p-table-header">ÎÇ†Ïßú</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr class="p-table-row" th:each="point : ${pointHistoryList}">
                            <td class="p-table-cell" th:text="${point.reason}">Ìè¨Ïù∏Ìä∏ Ï†ÅÎ¶Ω</td>
                            <td class="p-table-cell" th:text="${point.changePoint}" 
                                th:classappend="${point.changePoint > 0} ? 'p-point-positive' : 'p-point-negative'"></td>
                            <td class="p-table-cell" th:text="${point.type}" 
                                th:classappend="${point.type == 'EARN'} ? 'p-point-type-earn' : 'p-point-type-use'"></td>
                            <td class="p-table-cell" th:text="${#temporals.format(point.pointCreate, 'yyyy-MM-dd HH:mm')}"></td>
                        </tr>
                        <tr th:if="${#lists.isEmpty(pointHistoryList)}">
                            <td colspan="4" class="p-table-cell p-empty-message">
                                üòî Ìè¨Ïù∏Ìä∏ ÏÇ¨Ïö© ÎÇ¥Ïó≠Ïù¥ ÏóÜÏäµÎãàÎã§.
                                <br>Ìè¨Ïù∏Ìä∏Î•º Ï†ÅÎ¶ΩÌïòÍ≥† ÏÇ¨Ïö©Ìï¥Î≥¥ÏÑ∏Ïöî!
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>

            <div class="p-pagination">
                <span th:if="${startPage > 0}">
                    <a th:href="@{|/point/list?memberId=${memberId}&page=${startPage - 1}|}">&laquo; Ïù¥Ï†Ñ</a>
                </span>

                <span th:each="i : ${#numbers.sequence(startPage, endPage - 1)}">
                    <a th:href="@{|/point/list?memberId=${memberId}&page=${i}|}"
                       th:text="${i + 1}"
                       th:classappend="${i} == ${currentPage} ? 'p-active' : ''">1</a>
                </span>

                <span th:if="${endPage < totalPages}">
                    <a th:href="@{|/point/list?memberId=${memberId}&page=${endPage}|}">Îã§Ïùå &raquo;</a>
                </span>
            </div>
            
            <div class="p-status-bar">
                <div>Ìè¨Ïù∏Ìä∏ ÎÇ¥Ïó≠ Ï°∞Ìöå ÏôÑÎ£å</div>
                <div th:text="|Ï¥ù ${totalElements}Í∞ú Ìï≠Î™©|">Ï¥ù 0Í∞ú Ìï≠Î™©</div>
            </div>
        </div>
    </div>

<script>
	document.addEventListener('DOMContentLoaded', function() {
	    // ÌÖåÏù¥Î∏î Ìñâ ÌÅ¥Î¶≠ Ìö®Í≥º
	    const rows = document.querySelectorAll('.p-table-row');
	    rows.forEach(row => {
	        row.addEventListener('click', function() {
	            // Í∏∞Ï°¥ ÏÑ†ÌÉù Ìï¥Ï†ú
	            rows.forEach(r => {
	                r.style.background = '';
	                r.style.color = '';
	            });
	            // ÌòÑÏû¨ Ìñâ ÏÑ†ÌÉù
	            this.style.background = '#0078d4';
	            this.style.color = 'white';
	        });
	    });
	    
	    // iframe ÎÜíÏù¥ ÏûêÎèô Ï°∞Ï†à Ìï®Ïàò
	    function resizeIframe() {
	        try {
	            // ÌòÑÏû¨ Î¨∏ÏÑúÏùò Ï†ÑÏ≤¥ ÎÜíÏù¥ Í≥ÑÏÇ∞
	            const bodyHeight = document.body.scrollHeight;
	            const windowHeight = document.documentElement.scrollHeight;
	            const contentHeight = Math.max(bodyHeight, windowHeight);
	            
	            // Î∂ÄÎ™® windowÏóê Î©îÏãúÏßÄ Ï†ÑÏÜ° (iframe Ïô∏Î∂ÄÏóêÏÑú ÌÅ¨Í∏∞ Ï°∞Ï†à)
	            if (window.parent && window.parent !== window) {
	                window.parent.postMessage({
	                    type: 'resizeIframe',
	                    height: contentHeight + 20, // Ïó¨Î∞± Ï∂îÍ∞Ä
	                    source: 'pointHistory'
	                }, '*');
	            }
	        } catch (e) {
	            console.log('iframe resize error:', e);
	        }
	    }
	    
	    // Ï¥àÍ∏∞ Î°úÎìú Ïãú ÌÅ¨Í∏∞ Ï°∞Ï†à
	    resizeIframe();
	    
	    // Ï∞Ω ÌÅ¨Í∏∞ Î≥ÄÍ≤Ω Ïãú Ïû¨Ï°∞Ï†à
	    window.addEventListener('resize', resizeIframe);
	    
	    // MutationObserverÎ°ú DOM Î≥ÄÍ≤Ω Í∞êÏßÄ
	    const observer = new MutationObserver(function(mutations) {
	        let shouldResize = false;
	        mutations.forEach(function(mutation) {
	            if (mutation.type === 'childList' || mutation.type === 'attributes') {
	                shouldResize = true;
	            }
	        });
	        if (shouldResize) {
	            setTimeout(resizeIframe, 100); // ÏïΩÍ∞ÑÏùò ÏßÄÏó∞ ÌõÑ ÌÅ¨Í∏∞ Ï°∞Ï†à
	        }
	    });
	    
	    // DOM Î≥ÄÍ≤Ω Í¥ÄÏ∞∞ ÏãúÏûë
	    observer.observe(document.body, {
	        childList: true,
	        subtree: true,
	        attributes: true,
	        attributeFilter: ['style', 'class']
	    });
	    
	    // ÌÖåÏù¥Î∏î Îç∞Ïù¥ÌÑ∞ Î°úÎìú ÏôÑÎ£å Ïãú ÌÅ¨Í∏∞ Ïû¨Ï°∞Ï†à
	    setTimeout(function() {
	        resizeIframe();
	    }, 500);
	});

</script>
</div>
</body>
</html>