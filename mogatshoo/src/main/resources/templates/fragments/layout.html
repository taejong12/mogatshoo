<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title layout:title-pattern="$LAYOUT_TITLE - $CONTENT_TITLE" th:text="${layoutTitle} ?: 'Mogatshoo'">Mogatshoo</title>

    <!-- Bootstrap CSS -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">

    <!-- Í≥µÌÜµ Ïä§ÌÉÄÏùºÏãúÌä∏ -->
    <link th:href="@{/css/main/layout.css}" rel="stylesheet">
    <link th:href="@{/css/main/sidebar.css}" rel="stylesheet">
    <link th:href="@{/css/main/footer.css}" rel="stylesheet">

    <!-- ÌéòÏù¥ÏßÄÎ≥Ñ Ï∂îÍ∞Ä Ïä§ÌÉÄÏùº -->
    <th:block layout:fragment="additionalStyles"></th:block>
	

	<script>
		(function() {
		    'use strict';

		    const currentPath = window.location.pathname;
		    const isInIframe = window.self !== window.top;

		    // ÌòÑÏû¨ ÌôîÎ©¥ ÎÑàÎπÑ
		    const screenWidth = window.innerWidth;

		    console.log("üîç ÌéòÏù¥ÏßÄ Ï≤¥ÌÅ¨:", {
		        path: currentPath,
		        iframe: isInIframe,
		        screenWidth: screenWidth
		    });

		    // Î™®Î∞îÏùº ÌôîÎ©¥ ÌÅ¨Í∏∞ Î≤îÏúÑ (360 ~ 414)
		    const isMobileWidth = screenWidth >= 360 && screenWidth <= 414;

		    // ÏïÑÏù¥ÌîÑÎ†àÏûÑ Ï†ÑÏö© Í≤ΩÎ°úÎì§
		    const iframeOnlyPaths = [
		        '/hairLossTest/',
		        '/fortune/',
		        '/hospitalMap/',
		        '/point/',
		        '/member/mypage',
				'/voting/',
				'/question/'
				
		    ];

		    const isIframeOnlyPath = iframeOnlyPaths.some(path => currentPath.startsWith(path));

		    // **Î™®Î∞îÏùº ÌôîÎ©¥Ïùº Í≤ΩÏö∞ Ïà®ÍπÄ Í∏∞Îä• Ïã§Ìñâ ÏïàÌï®**
		    if (isIframeOnlyPath && !isInIframe && !isMobileWidth) {
		        console.log("üóëÔ∏è ÏßÅÏ†ë Ï†ëÍ∑º Í∞êÏßÄ - ÏΩòÌÖêÏ∏† ÏôÑÏ†Ñ Ï†úÍ±∞");

		        function hideContent() {
		            const contentSelectors = [
		                '[layout\\:fragment="content"]',
		                '.content-with-sidebar > div',
		                '.content-with-sidebar',
		                '.main-container',
		                'main .container',
		                '.container .row',
		                '.pixel-bg .main-container',
		                '.retro-panel'
		            ];

		            let contentFound = false;

		            contentSelectors.forEach(selector => {
		                const elements = document.querySelectorAll(selector);
		                elements.forEach(element => {
		                    if (element && element.innerHTML.trim() !== '') {
		                        console.log("üóëÔ∏è ÏΩòÌÖêÏ∏† Ï†úÍ±∞:", selector);
		                        element.innerHTML = '';
		                        element.style.minHeight = 'calc(100vh - 200px)';
		                        element.style.backgroundColor = '#008080';
		                        element.style.display = 'flex';
		                        element.style.alignItems = 'center';
		                        element.style.justifyContent = 'center';
		                        contentFound = true;
		                    }
		                });
		            });

		            if (!contentFound) {
		                console.log("üî® Í∞ïÏ†ú ÏΩòÌÖêÏ∏† Ïà®ÍπÄ");
		                const style = document.createElement('style');
		                style.textContent = `
		                    .retro-panel,
		                    .main-container > .container,
		                    .pixel-bg .main-container > .container,
		                    [layout\\:fragment="content"] > *,
		                    .content-with-sidebar > div:not(.empty-space) {
		                        display: none !important;
		                    }
		                    
		                    .content-with-sidebar {
		                        min-height: calc(100vh - 200px) !important;
		                        background-color: #008080 !important;
		                        display: flex !important;
		                        align-items: center !important;
		                        justify-content: center !important;
		                    }
		                `;
		                document.head.appendChild(style);
		            }
		            console.log("‚úÖ ÏΩòÌÖêÏ∏† Ïà®ÍπÄ ÏôÑÎ£å");
		        }

		        if (document.readyState === 'loading') {
		            document.addEventListener('DOMContentLoaded', hideContent);
		        } else {
		            hideContent();
		        }

		        setTimeout(hideContent, 500);
		        setTimeout(hideContent, 1000);
		    }

		    // ÏïÑÏù¥ÌîÑÎ†àÏûÑÏóêÏÑúÎäî ÏÇ¨Ïù¥ÎìúÎ∞î/Ìë∏ÌÑ∞ Ïà®Í∏∞Í∏∞ (Í∏∞Ï°¥Í≥º ÎèôÏùº)
		    if (isInIframe) {
		        setTimeout(() => {
		            const sidebar = document.querySelector('.sidebar');
		            const footer = document.querySelector('.footer-area, .footer');

		            if (sidebar) {
		                sidebar.style.display = 'none';
		                console.log("üîí ÏÇ¨Ïù¥ÎìúÎ∞î Ïà®ÍπÄ");
		            }
		            if (footer) {
		                footer.style.display = 'none';
		                console.log("üîí Ìë∏ÌÑ∞ Ïà®ÍπÄ");
		            }

		            const contentWithSidebar = document.querySelector('.content-with-sidebar');
		            if (contentWithSidebar) {
		                contentWithSidebar.style.marginLeft = '0';
		                contentWithSidebar.style.width = '100%';
		            }
		        }, 100);
		    }
		})();

	</script>
</head>

<body th:classappend="${mainPage} ? 'main-page' : ''">
    <div class="page-container d-flex flex-column min-vh-100">
        
        <!-- Î≥∏Î¨∏ Î∞è ÏÇ¨Ïù¥ÎìúÎ∞î -->
        <main class="flex-fill content-area">
            <div class="content-wrapper container-fluid">
                <div class="sidebar-content-container d-flex">
                    
                    <!-- ÏÇ¨Ïù¥ÎìúÎ∞î -->
                    <aside class="sidebar" th:replace="~{fragments/sidebar :: sidebar}"></aside>

                    <!-- ÏΩòÌÖêÏ∏† -->
                    <section class="content-with-sidebar flex-grow-1">
						<!-- Î≥∏Î¨∏ ÏòÅÏó≠ -->
						<div layout:fragment="content"></div>
                    </section>
                </div>
            </div>
        </main>

        <!-- Ìë∏ÌÑ∞ -->
        <footer class="footer-area mt-auto">
            <div th:replace="~{fragments/footer :: footer}" class="footer"></div>
        </footer>
    </div>

    <!-- Bootstrap JS (Popper Ìè¨Ìï®) -->
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>

		
    <!-- Í≥µÌÜµ Ïä§ÌÅ¨Î¶ΩÌä∏ -->
    <script th:src="@{/js/main/sidebar.js}"></script>
	<script th:src="@{/js/main/footer.js}"></script>

    <!-- ÌéòÏù¥ÏßÄÎ≥Ñ Ï∂îÍ∞Ä Ïä§ÌÅ¨Î¶ΩÌä∏ -->
    <th:block layout:fragment="additionalScripts"></th:block>
</body>
</html>
