<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org" xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout">

<head>
	<meta charset="UTF-8">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
	<title layout:title-pattern="$LAYOUT_TITLE - $CONTENT_TITLE" th:text="${layoutTitle} ?: 'Mogatshoo'">Mogatshoo
	</title>


	<!-- ê³µí†µ ìŠ¤íƒ€ì¼ì‹œíŠ¸ -->
	<link th:href="@{/css/main/layout.css}" rel="stylesheet">
	<link th:href="@{/css/main/sidebar.css}" rel="stylesheet">
	<link th:href="@{/css/main/footer.css}" rel="stylesheet">

	<th:block layout:fragment="additionalStyles">
	    
	</th:block>

	<script>
		(function() {
			    'use strict';

			    const currentPath = window.location.pathname;
			    const isInIframe = window.self !== window.top;
			    const screenWidth = window.innerWidth;

			    // ëª¨ë°”ì¼ ê¸°ê¸° ê°ì§€ (User Agent + í™”ë©´ í¬ê¸°)
			    const isMobileDevice = /Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent) || screenWidth <= 768;

			    console.log("ğŸ” í˜ì´ì§€ ì²´í¬:", {
			        path: currentPath,
			        iframe: isInIframe,
			        screenWidth: screenWidth,
			        isMobile: isMobileDevice
			    });

			    // ì•„ì´í”„ë ˆì„ ì „ìš© ê²½ë¡œë“¤
			    const iframeOnlyPaths = [
				'/hairLossTest/',
								'/fortune/',
								'/hospitalMap/',
								'/point/',
								'/member/mypage', '/member/complete', '/member/findById', '/member/findByPwd', '/member/lost', '/member/pwdUpdateForm', '/member/update',
								'/voting/','/voting'
								
			    ];

			    const isIframeOnlyPath = iframeOnlyPaths.some(path => currentPath.startsWith(path));

			    // â­ í•µì‹¬: ëª¨ë°”ì¼ì—ì„œëŠ” ì•„ì´í”„ë ˆì„ ì œì•½ì„ ë¬´ì‹œí•˜ê³  ì½˜í…ì¸  í‘œì‹œ
			    if (isIframeOnlyPath && !isInIframe && !isMobileDevice) {
			        // ë°ìŠ¤í¬í†±ì—ì„œë§Œ ì½˜í…ì¸  ìˆ¨ê¹€
			        console.log("ğŸ—‘ï¸ ë°ìŠ¤í¬í†±ì—ì„œ ì§ì ‘ ì ‘ê·¼ ê°ì§€ - ì½˜í…ì¸  ìˆ¨ê¹€");
			        hideContent();
			    } else if (isIframeOnlyPath && !isInIframe && isMobileDevice) {
			        // ëª¨ë°”ì¼ì—ì„œëŠ” ì½˜í…ì¸  ì •ìƒ í‘œì‹œí•˜ë˜ ë ˆì´ì•„ì›ƒë§Œ ì¡°ì •
			        console.log("ğŸ“± ëª¨ë°”ì¼ì—ì„œ ì§ì ‘ ì ‘ê·¼ - ì½˜í…ì¸  í‘œì‹œí•˜ê³  ë ˆì´ì•„ì›ƒ ì¡°ì •");
			        adjustMobileLayout();
			    }

			    // ì•„ì´í”„ë ˆì„ì—ì„œëŠ” ê¸°ì¡´ ë¡œì§ ìœ ì§€
			    if (isInIframe) {
			        setTimeout(() => {
			            const sidebar = document.querySelector('.sidebar');
			            const footer = document.querySelector('.footer-area, .footer');

			            if (sidebar) {
			                sidebar.style.display = 'none';
			                console.log("ğŸ”’ ì•„ì´í”„ë ˆì„: ì‚¬ì´ë“œë°” ìˆ¨ê¹€");
			            }
			            if (footer) {
			                footer.style.display = 'none';
			                console.log("ğŸ”’ ì•„ì´í”„ë ˆì„: í‘¸í„° ìˆ¨ê¹€");
			            }

			            const contentWithSidebar = document.querySelector('.content-with-sidebar');
			            if (contentWithSidebar) {
			                contentWithSidebar.style.marginLeft = '0';
			                contentWithSidebar.style.width = '100%';
			            }
			        }, 100);
			    }

			    // ëª¨ë°”ì¼ ë ˆì´ì•„ì›ƒ ì¡°ì • í•¨ìˆ˜
			    function adjustMobileLayout() {
			        setTimeout(() => {
			            // ì‚¬ì´ë“œë°” ìˆ¨ê¸°ê¸° (ëª¨ë°”ì¼ì—ì„œëŠ” í•„ìš”ì—†ìŒ)
			            const sidebar = document.querySelector('.sidebar');
			            if (sidebar) {
			                sidebar.style.display = 'none';
			                console.log("ğŸ“± ëª¨ë°”ì¼: ì‚¬ì´ë“œë°” ìˆ¨ê¹€");
			            }

			            // ì½˜í…ì¸  ì˜ì—­ ì „ì²´ ë„ˆë¹„ë¡œ ì¡°ì •
			            const contentWithSidebar = document.querySelector('.content-with-sidebar');
			            if (contentWithSidebar) {
			                contentWithSidebar.style.marginLeft = '0';
			                contentWithSidebar.style.width = '100%';
			                contentWithSidebar.style.padding = '0px';
			                console.log("ğŸ“± ëª¨ë°”ì¼: ì½˜í…ì¸  ì˜ì—­ ì¡°ì •");
			            }

			            // í‘¸í„°ëŠ” ëª¨ë°”ì¼ì—ì„œë„ í‘œì‹œ (ì„ íƒì‚¬í•­)
			            const footer = document.querySelector('.footer-area, .footer');
			            if (footer) {
			                footer.style.display = 'block';
			                console.log("ğŸ“± ëª¨ë°”ì¼: í‘¸í„° í‘œì‹œ");
			            }
			        }, 100);
			    }

			    // ì½˜í…ì¸  ìˆ¨ê¹€ í•¨ìˆ˜ (ë°ìŠ¤í¬í†± ì „ìš©)
			    function hideContent() {
			        const contentSelectors = [
			            '[layout\\:fragment="content"]',
			            '.content-with-sidebar > div',
			            '.content-with-sidebar',
			            '.main-container',
			            'main .container',
			            '.container .row',
			            '.pixel-bg .main-container',
			            '.retro-panel'
			        ];

			        let contentFound = false;

			        contentSelectors.forEach(selector => {
			            const elements = document.querySelectorAll(selector);
			            elements.forEach(element => {
			                if (element && element.innerHTML.trim() !== '') {
			                    console.log("ğŸ—‘ï¸ ì½˜í…ì¸  ì œê±°:", selector);
			                    element.innerHTML = '';
			                    element.style.minHeight = 'calc(100vh - 200px)';
			                    element.style.backgroundColor = '#008080';
			                    element.style.display = 'flex';
			                    element.style.alignItems = 'center';
			                    element.style.justifyContent = 'center';
			                    contentFound = true;
			                }
			            });
			        });

			        if (!contentFound) {
			            console.log("ğŸ”¨ ê°•ì œ ì½˜í…ì¸  ìˆ¨ê¹€");
			            const style = document.createElement('style');
			            style.textContent = `
			                .retro-panel,
			                .main-container > .container,
			                .pixel-bg .main-container > .container,
			                [layout\\:fragment="content"] > *,
			                .content-with-sidebar > div:not(.empty-space) {
			                    display: none !important;
			                }
			                
			                .content-with-sidebar {
			                    min-height: calc(100vh - 200px) !important;
			                    background-color: #008080 !important;
			                    display: flex !important;
			                    align-items: center !important;
			                    justify-content: center !important;
			                }
			            `;
			            document.head.appendChild(style);
			        }
			        console.log("âœ… ì½˜í…ì¸  ìˆ¨ê¹€ ì™„ë£Œ");
			    }
			})();
	</script>
	
</head>

<body th:classappend="${mainPage} ? 'main-page' : ''">
	<div class="page-container d-flex flex-column min-vh-100">

		<!-- ë³¸ë¬¸ ë° ì‚¬ì´ë“œë°” -->
		<main class="flex-fill content-area">
			<div class="content-wrapper container-fluid">
				<div class="sidebar-content-container d-flex">

					<!-- ì‚¬ì´ë“œë°” -->
					<aside class="sidebar" th:replace="~{fragments/sidebar :: sidebar}"></aside>

					<!-- ì½˜í…ì¸  -->
					<section class="content-with-sidebar flex-grow-1">
						<!-- ë³¸ë¬¸ ì˜ì—­ -->
						<div layout:fragment="content"></div>
					</section>
				</div>
			</div>
		</main>

		<!-- í‘¸í„° -->
		<footer class="footer-area mt-auto">
			<div th:replace="~{fragments/footer :: footer}" class="footer"></div>
		</footer>
	</div>



	<!-- ê³µí†µ ìŠ¤í¬ë¦½íŠ¸ -->
	<script th:src="@{/js/main/sidebar.js}"></script>
	<script th:src="@{/js/main/footer.js}"></script>

	<!-- í˜ì´ì§€ë³„ ì¶”ê°€ ìŠ¤í¬ë¦½íŠ¸ -->
	<th:block layout:fragment="additionalScripts"></th:block>
</body>

</html>